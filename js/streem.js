function goToUrl(){$(location).attr("href","http://zenit.staffboost.ru/public/root/signin.html")}document.addEventListener("DOMContentLoaded",(function(){console.log(localStorage.getItem("userToken")),null!==localStorage.getItem("userToken")&&"undefined"!=localStorage.getItem("userToken")||(console.log("fas1"),goToUrl())})),$((function(){var e="";$(document).on("click",".musical-vote .btn",(function(){$(this).parents(".musical-vote__list").addClass("musical-vote__success")}));let t=$(".streem-chat__messages");function s(){t.height("0px");let e=t.parent().height(),s=t.next().height();t.height(e-s-10+"px")}$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,(function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""})),e};var n=$(".streem-chat__files-name");function a(){t.scrollTop(9999999)}function i(e){let s=e.authentication.created_at.substr(11,5),n='<div class="streem-chat__message"><div class="streem-chat__username">'+e.authentication.nick+'</div><div class="streem-chat__name">'+e.authentication.name+"</div><p>"+e.message+'</p><div class="streem-chat__time">'+s+"</div></div>";t.append(n),a()}function o(){$.ajax({url:"http://zenit.staffboost.ru/api/chat/message/get",type:"POST",data:{},dataType:"html"}).done((function(e){let t=$.parseJSON(e);for(let e in t.messages)i(t.messages[e])})).fail((function(e){console.log(e)}))}$(document).on("change",".streem-chat__file input",(function(){!function(t,a){if(t.files&&t.files[0]){var i=new FileReader;i.onload=function(a){n.html('<div class="streem-chat__file-name">'+t.files[0].name+' <div class="streem-chat__file-close"></div></div>'),e=i.result,s()},i.readAsDataURL(t.files[0])}}(this,$(this))})),$(document).on("click",".streem-chat__file-close",(function(){$(this).parent().remove(),s()})),$(window).resize((function(){$(window).width()>1199?(s(),console.log($(window).width())):(t.height(""),console.log($(window).width()))})),s(),a(),o(),$(".streem-chat__form").submit((function(t){var s,n=$(this).serializeObject(),a="token="+localStorage.getItem("userToken")+"&message="+n.message;return""!=e&&(a+="&file="+e),s=a,$.ajax({url:"http://zenit.staffboost.ru/api/chat/message/send",type:"POST",data:s,dataType:"html"}).done((function(e){let t=$.parseJSON(e);console.log("success"),console.log(t),o()})).fail((function(e){console.log(e)})),!1}))}));